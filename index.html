<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ebdi Group</title>
    <link rel="stylesheet" href="Style.css">
</head>
<body>

    <!-- Telas dinamicamente geradas pelo JS -->
    <div id="telas-container"></div>

    <script>
        const apis = [
            // URL das APIs com os tÃ­tulos atualizados conforme os comentÃ¡rios
            {
Â  Â  Â  Â  Â  Â  Â  Â  url:"https://script.google.com/macros/s/AKfycbz8iQDy9pRrWbV8vipqLHkJ4AFGomfUAW8n-l5dtkaBQj8xmgMmfOd39Rof6IcziSbXag/exec",
Â  Â  Â  Â  Â  Â  Â  Â  titulo: "Meta Convites"
Â  Â  Â  Â  Â  Â  },
            {
Â  Â  Â  Â  Â  Â  Â  Â  url:"https://script.google.com/macros/s/AKfycbwmhOpG86m9I2Foip5FfNLwyvYNIZfomSpJ2YT59Qp14DHbkVsTbUx0_xcyP6Awsyr0sg/exec",
Â  Â  Â  Â  Â  Â  Â  Â  titulo: "Meta Convites"
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â    {
Â  Â  Â  Â  Â  Â  Â  Â  url:"https://script.google.com/macros/s/AKfycbyIvuCF_0PL22mQZQrQFgQyXpnNxHobzhFCNfWsGqLqu-vm0Hhe4jl0O8hmU1CcxV9k7Q/exec",
Â  Â  Â  Â  Â  Â  Â  Â  titulo:"Red Hat & AWS 25.09"
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â    {
Â  Â  Â  Â  Â  Â  Â  Â  url:"https://script.google.com/macros/s/AKfycbw8agSsXThUWVqhOIoasF-9iF9Q67iMkhApDURVNCLE3_OpgJtn-GXpQ5H81fQrqxsgOw/exec",
Â  Â  Â  Â  Â  Â  Â  Â  titulo:"Monday 07.10"
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â    {
Â  Â  Â  Â  Â  Â  Â  Â  url:"https://script.google.com/macros/s/AKfycbxZFhZThOkA2DgpGDDVIN8Nack1KCl1o2GEwDjzTej2he5sthL504JSTvteFqsrFeDzxQ/exec",
Â  Â  Â  Â  Â  Â  Â  Â  titulo:"AWS SP 08.10"
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  url:"https://script.google.com/macros/s/AKfycbxHAa87M7c3aQ8wLmBjVyPmzsOZ3h-4Ab4mtq15tAO_w6Rns7yYG0YL6TzW-HdyR0mr1Q/exec",
Â  Â  Â  Â  Â  Â  Â  Â  titulo:"DocuSign 23.09"
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  url:"https://script.google.com/macros/s/AKfycbxEcVGcjqROqMHmD13zjjrdIYPt78ewxx9gKM0L5lp55k7iCXx6F1OIfvD4EebaTMamPw/exec",
Â  Â  Â  Â  Â  Â  Â  Â  titulo:"AWS PORTO ALEGRE 23.09"
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  url:"https://script.google.com/macros/s/AKfycbzkhtCz75fnDpSA9jcoRgj2njO7maht2FIvAYqcWNuKbHAWJgklp43ak1cEf9VolRWvMw/exec",
Â  Â  Â  Â  Â  Â  Â  Â  titulo:"Agency - Elsa 24.09"
Â  Â  Â  Â  Â  Â  },

        ];

        const telasContainer = document.getElementById('telas-container');

        // FunÃ§Ã£o para criar as telas
        function criarTelas() {
            apis.forEach((api, index) => {
                const tela = document.createElement('div');
                tela.id = `tela${index + 1}`;
                tela.style.display = index === 0 ? 'block' : 'none'; // Exibe a primeira tela inicialmente
                tela.innerHTML = `
                    <h1 class="title">${api.titulo}</h1>
                    <div class="container" id="container${index + 1}">
                        <p>Carregando dados...ðŸš€</p>
                    </div>
                `;
                telasContainer.appendChild(tela);
            });
        }

        // FunÃ§Ã£o assÃ­ncrona para carregar os dados das APIs
        async function carregarDados() {
            try {
                const dados = await Promise.all(apis.map(async api => {
                    try {
                        const res = await fetch(api.url);
                        if (!res.ok) throw new Error(`Erro HTTP ${res.status}`);
                        return await res.json();
                    } catch (e) {
                        console.warn(`Erro ao buscar dados da API "${api.titulo}":`, e);
                        return [];
                    }
                }));
                exibirDados(dados);
            } catch (error) {
                console.error("Erro ao carregar os dados:", error);
            }
        }

        // FunÃ§Ã£o para exibir os dados de forma organizada
        function exibirDados(dados) {
    dados.forEach((data, index) => {
        const container = document.getElementById(`container${index + 1}`);
        container.innerHTML = "";

        if (!Array.isArray(data) || data.length === 0) {
            container.innerHTML = "<p>Nenhum dado encontrado.</p>";
            return;
        }

        // Separar o item SLA dos demais
        let slaItem = data.find(item => item.nome && item.nome.toLowerCase().includes("sla"));
        let outros = data.filter(item => !(item.nome && item.nome.toLowerCase().includes("sla")));

        // Ordenar os demais pela porcentagem de meta alcanÃ§ada
        outros.sort((a, b) => {
            const percentualA = parseInt(a.meta) > 0 ? Math.round((parseInt(a.alcancado) / parseInt(a.meta)) * 100) : 100;
            const percentualB = parseInt(b.meta) > 0 ? Math.round((parseInt(b.alcancado) / parseInt(b.meta)) * 100) : 100;
            return percentualB - percentualA;
        });

        // Junta SLA primeiro (se existir), depois os outros
        const ordenados = slaItem ? [slaItem, ...outros] : outros;

        // Exibindo os dados de cada item
        ordenados.forEach((item, i) => {
            const nome = item.nome || `P${i + 1}`;
            const meta = Number(item.meta) || 0;
            const alcancado = Number(item.alcancado) || 0;
            let percentual = meta > 0 ? Math.round((alcancado / meta) * 100) : 100;
            const percentualExibido = percentual;
            percentual = percentual > 100 ? 100 : percentual;
            const corBarra = percentualExibido < 50 ? "#dc3545" : percentualExibido < 100 ? "#ffc107" : "#28a745";

            // CriaÃ§Ã£o do card para exibir os dados
            const card = document.createElement('div');
            card.className = 'card';

            // Adiciona coroa se meta >= 100%
            const coroaHTML = percentualExibido >= 100 ? `<div style="text-align: center; font-size: 35px; margin-bottom: 10px;">ðŸ‘‘</div>` : "";

            card.innerHTML = `
                <div class="card-body">
                    ${coroaHTML}
                    <h3 style="text-align: center;">${nome}</h3>
                    <p style="text-align: center;">Meta: <span>${meta}</span></p>
                    <p style="text-align: center;">AlcanÃ§ado: <span>${alcancado}</span></p>
                    <div class="progress" style="background-color: white; border-radius: 10px; border: 1px solid #ccc; box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.1);">
                        <div class="progress-bar" style="width: ${percentual}%; background: ${corBarra}; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                            <span style="color: #000; font-weight: bold;">${percentualExibido}%</span>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(card);
        });
    });
}

        // FunÃ§Ã£o para alternar entre as telas
        let indiceTela = 0;
        function mudarTela() {
            apis.forEach((_, i) => {
                document.getElementById(`tela${i + 1}`).style.display = 'none';
            });
            document.getElementById(`tela${indiceTela + 1}`).style.display = 'block';
            indiceTela = (indiceTela + 1) % apis.length;
        }

        // InicializaÃ§Ã£o da pÃ¡gina
        window.onload = () => {
            criarTelas();
            carregarDados();
            setInterval(carregarDados, 30000); // Atualiza dados a cada 30 segundos
            mudarTela();
            setInterval(mudarTela, 10000); // Troca tela a cada 10 segundos
        };
    </script>
</body>
</html>
